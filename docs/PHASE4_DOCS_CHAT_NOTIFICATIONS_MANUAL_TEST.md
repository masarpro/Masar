# Phase 4 - Documents, Chat & Notifications - Manual Test Checklist

## المستندات والاعتمادات (Documents & Approvals)

### قائمة المستندات
- [ ] الانتقال إلى `/app/[orgSlug]/projects/[projectId]/documents`
- [ ] عرض قائمة المستندات (أو حالة فارغة إذا لم تكن هناك مستندات)
- [ ] تصفية المستندات حسب المجلد (العقد، المخططات، المستخلصات، الخطابات، الصور، أخرى)
- [ ] البحث عن مستند بالعنوان
- [ ] رؤية شارة حالة الاعتماد في كل مستند

### إنشاء مستند
- [ ] الانتقال إلى `/app/[orgSlug]/projects/[projectId]/documents/new`
- [ ] ملء النموذج:
  - [ ] اختيار المجلد
  - [ ] إدخال العنوان
  - [ ] إدخال رابط الملف (URL)
  - [ ] إضافة وصف (اختياري)
- [ ] إرسال النموذج والتحقق من إنشاء المستند بنجاح
- [ ] التحقق من ظهور المستند في القائمة

### تفاصيل المستند
- [ ] الانتقال إلى `/app/[orgSlug]/projects/[projectId]/documents/[documentId]`
- [ ] عرض معلومات المستند (العنوان، المجلد، الوصف)
- [ ] زر فتح الملف يعمل
- [ ] عرض معلومات المنشئ وتاريخ الإنشاء
- [ ] عرض سجل التدقيق (Audit Log)

### الاعتمادات
- [ ] طلب اعتماد على مستند (إذا كان الزر متاحاً)
- [ ] التحقق من إنشاء إشعار للمعتمدين
- [ ] تسجيل الدخول كمعتمد ورؤية طلب الاعتماد
- [ ] الموافقة على طلب الاعتماد
- [ ] التحقق من تحديث حالة الاعتماد
- [ ] التحقق من إنشاء إشعار لطالب الاعتماد

---

## المحادثات (Chat)

### صفحة المحادثات
- [ ] الانتقال إلى `/app/[orgSlug]/projects/[projectId]/chat`
- [ ] عرض تبويبين: محادثة الفريق ومحادثة المالك

### محادثة الفريق (TEAM)
- [ ] اختيار تبويب محادثة الفريق
- [ ] عرض الرسائل السابقة (أو حالة فارغة)
- [ ] إرسال رسالة جديدة
- [ ] التحقق من ظهور الرسالة فوراً
- [ ] زر التحديث يعمل

### محادثة المالك (OWNER)
- [ ] اختيار تبويب محادثة المالك
- [ ] التحقق من ظهور تنبيه أن هذه قناة رسمية
- [ ] إرسال رسالة في قناة المالك
- [ ] تفعيل "تحديث رسمي" عند الإرسال
- [ ] التحقق من ظهور شارة "تحديث رسمي" على الرسالة
- [ ] التحقق من إنشاء سجل تدقيق للرسائل في قناة المالك

---

## الإشعارات (Notifications)

### قائمة الإشعارات
- [ ] الانتقال إلى `/app/[orgSlug]/notifications`
- [ ] عرض قائمة الإشعارات
- [ ] عرض عدد الإشعارات غير المقروءة
- [ ] تصفية الإشعارات غير المقروءة فقط

### إدارة الإشعارات
- [ ] قراءة إشعار فردي
- [ ] قراءة جميع الإشعارات
- [ ] الضغط على إشعار للانتقال إلى المحتوى المرتبط

### أنواع الإشعارات
- [ ] إشعار طلب اعتماد جديد
- [ ] إشعار قرار اعتماد
- [ ] إشعار رسالة في قناة المالك

---

## الأمان والعزل (Security & Multi-tenancy)

### عزل البيانات
- [ ] محاولة الوصول لمستندات مشروع من منظمة أخرى (يجب أن يفشل)
- [ ] محاولة الوصول لمحادثات مشروع من منظمة أخرى (يجب أن يفشل)
- [ ] التحقق من أن كل query يحتوي على organizationId و projectId

### الصلاحيات
- [ ] مستخدم بدون صلاحية view لا يستطيع رؤية المستندات
- [ ] مستخدم بدون صلاحية edit لا يستطيع إنشاء مستند
- [ ] مستخدم ليس معتمداً لا يستطيع اتخاذ قرار على طلب اعتماد

### قناة المالك
- [ ] قناة المالك محدودة للمديرين والمالكين فقط (حسب الإعدادات)

---

## سجل التدقيق (Audit Trail)

### التحقق من التسجيل
- [ ] إنشاء مستند يسجل حدث DOC_CREATED
- [ ] طلب اعتماد يسجل حدث APPROVAL_REQUESTED
- [ ] قرار اعتماد يسجل حدث APPROVAL_DECIDED
- [ ] إرسال رسالة في قناة المالك يسجل حدث MESSAGE_SENT

---

## ملاحظات الاختبار

### القيود المعروفة
- المستندات حالياً تستخدم روابط URL فقط (لا يوجد رفع ملفات فعلي)
- المحادثات تستخدم polling (لا يوجد تحديث فوري)
- اختيار المعتمدين يحتاج تطوير إضافي في الواجهة

### الخطوات القادمة (Phase 5)
- بوابة المالك (Owner Portal)
- حسابات عملاء المشروع (PROJECT_CLIENT)
- إشعارات البريد الإلكتروني والـ Push

---

**التاريخ:** فبراير 2026
**الإصدار:** Phase 4
