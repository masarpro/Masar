# ุจุฑููุจุช ุฅุนุงุฏุฉ ููููุฉ ูุณู ุงูุชุณุนูุฑ โ ููุตุฉ ูุณุงุฑ

> **ุงููุถุน:** Plan Mode ุฃููุงู โ ุงุฏุฑุณ ุงููุดุฑูุน ุจุงููุงูู ุซู ุถุน ุฎุทุฉ ุชูุตูููุฉ ูุจู ุฃู ุชุนุฏูู
> **ุงูุฃููููุฉ:** ุนุงููุฉ โ ุชุบููุฑ ูุนูุงุฑู ุฌููุฑู

---

## ุงูุณูุงู ูุงููุฏู

ุฃูุช ุชุนูู ุนูู ููุตุฉ **ูุณุงุฑ** โ ูุธุงู SaaS ูุฅุฏุงุฑุฉ ุงูููุงููุงุช ูุจูู ุนูู Next.js 16 App Router + Prisma 7 + ORPC + BetterAuth.

### ุงููุดููุฉ ุงูุญุงููุฉ

ููุฌุฏ **ุชุถุงุฑุจ ูุนูุงุฑู** ุจูู ูุธุงููู ูุชูุงุฒููู ููุชุณุนูุฑ:

1. **ุนุฑูุถ ุงูุฃุณุนุงุฑ (Quotations)** ููุฌูุฏุฉ ุชุญุช ูุณู **ุงููุงููุฉ** (`/finance/quotations`) โ ุชุดูู: ุฅูุดุงุก ุนุฑูุถ ุฃุณุนุงุฑุ ุจููุฏุ ุชุญููู ููุงุชูุฑุฉุ ุญุงูุงุช (DRAFT โ SENT โ ACCEPTED โ REJECTED โ EXPIRED)
2. **ุฏุฑุงุณุงุช ุงููููุงุช (Quantities)** ูู ูุณู ูุณุชูู (`/quantities/*`) โ ุชุดูู: ุฏุฑุงุณุฉ ุงูุชูููุฉ (CostStudy)ุ ุจููุฏ ุฅูุดุงุฆูุฉ/ุชุดุทูุจุงุช/ููุฑููููุงููู/ุนูุงูุฉุ ุชุณุนูุฑ ูุน ููุงูุด ุฑุจุญ
3. ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุฌุฏ ุฌุฏููุงู ูุชุดุงุจูุงู: `Quote` (ูุฑุชุจุท ุจุงููููุงุช) ู `Quotation` + `QuotationItem` (ูุฑุชุจุท ุจุงููุงููุฉ)

### ุงููุฏู

**ููู ุนุฑูุถ ุงูุฃุณุนุงุฑ ูู ูุณู ุงููุงููุฉ โ ุฅูุดุงุก ูุณู ุฌุฏูุฏ ุงุณูู "ุงูุชุณุนูุฑ" ูุฌูุน:**
- ุฏุฑุงุณุงุช ุงููููุงุช (ุงูููุฌูุฏุฉ ุญุงููุงู ูู `/quantities`)
- ุนุฑูุถ ุงูุฃุณุนุงุฑ (ุงููููููุฉ ูู `/finance/quotations`)
- ูุณุงุฑ ูุงุถุญ: ุญุตุฑ ูููุงุช โ ุชุณุนูุฑ โ ุนุฑุถ ุณุนุฑ โ (ูุจูู) โ ุชุญููู ููุดุฑูุน/ุนูุฏ

### ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ

| ุงููุณู | ูุธููุชู |
|-------|--------|
| **ุงูุชุณุนูุฑ** | ูู ูุง ูู **ูุจู ุงูุชุนุงูุฏ** (ูููุงุช + ุชุณุนูุฑ + ุนุฑูุถ ุฃุณุนุงุฑ) |
| **ุงููุงููุฉ** | ูู ูุง ูู **ุจุนุฏ ุงูุชุนุงูุฏ** (ููุงุชูุฑ + ูุฏููุนุงุช + ูุตุฑููุงุช + ุญุณุงุจุงุช) |

---

## ุงููุทููุจ ููู โ ูุฑุญูุฉ ุงูุฏุฑุงุณุฉ (Plan Mode)

### ุงูุฎุทูุฉ 1: ุงุฏุฑุณ ุงููููุงุช ุงูุชุงููุฉ ุจุนูุงูุฉ ุดุฏูุฏุฉ

**ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
```
packages/database/prisma/schema.prisma
```
ุงุจุญุซ ุนู ูุงุฏุฑุณ:
- ููุฏูู `Quotation` ู `QuotationItem` โ ูููููู ูุนูุงูุงุชูู
- ููุฏูู `Quote` โ ููููู ูุนูุงูุงุชู (ูุฑุชุจุท ุจู CostStudy)
- ููุฏูู `CostStudy` ู `StructuralItem` ู `FinishingItem` ู `MEPItem` ู `LaborItem`
- ููุฏูู `FinanceInvoice` โ ูุฃู `convertToInvoice` ูุฑุจุท Quotation ุจุงููุงุชูุฑุฉ
- ููุฏูู `Client` ู `ClientContact` โ ูุฃู Quotation ูุฑุชุจุท ุจุงูุนููู
- ุฃู enums ูุฑุชุจุทุฉ: `QuotationStatus` ูุบูุฑูุง
- ุฃู ุนูุงูุงุช (relations) ุชุฑุจุท ูุฐู ุงูููุฏููุงุช ุจุจุนุถูุง

**ุทุจูุฉ API โ ุนุฑูุถ ุงูุฃุณุนุงุฑ (ุงููุตุฏุฑ โ ุณููููู):**
```
packages/api/modules/finance/router.ts          โ ุงูุฑุงูุชุฑ ุงููุฑุนู ูููุงููุฉ
packages/api/modules/finance/quotations/        โ ูู ูููุงุช API ุงูุฎุงุตุฉ ุจุนุฑูุถ ุงูุฃุณุนุงุฑ
```
ุงุฏุฑุณ:
- ูู ุงูู procedures: `list`, `getById`, `create`, `update`, `updateItems`, `updateStatus`, `delete`, `convertToInvoice`
- ููู ูุชู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช (permissions)
- ููู ูุชู ุงูุชุญูู ูู ุงูุนุถููุฉ (organizationId)
- ูุง ูู ุงูู Zod schemas ุงููุณุชุฎุฏูุฉ
- ุงูุนูุงูุฉ ูุน `convertToInvoice` โ ูู ูุจูู ุงูุฑุจุท ุฃู ูุชุบูุฑุ

**ุทุจูุฉ API โ ุงููููุงุช (ุงููุณู ุงูุญุงูู โ ุณูุชูุณุน):**
```
packages/api/modules/quantities/                โ ูู ูููุงุช API ุงููููุงุช
```
ุงุฏุฑุณ:
- ูููู ุงูุฑุงูุชุฑ ุงูุญุงูู
- ููู ูุชุนุงูู ูุน CostStudy
- ูู ููุฌุฏ `pricing` procedures ุญุงููุงู
- ููู ูุฑุชุจุท `Quote` ุจู `CostStudy`

**ุทุจูุฉ API โ ุงูุฑุงูุชุฑ ุงูุฑุฆูุณู:**
```
packages/api/orpc/router.ts                     โ ูุฌูุน ูู ุงูู 32 ูุญุฏุฉ
```

**ุงูุตูุงุญูุงุช:**
```
packages/database/prisma/permissions.ts          โ ูุตูููุฉ ุงูุตูุงุญูุงุช
packages/api/lib/permissions/                    โ ูููุงุช ุงูุชุญูู
```
ุงุจุญุซ ุนู:
- `finance.quotations` โ ุงูุตูุงุญูุงุช ุงูุญุงููุฉ
- `quantities.*` โ ุงูุตูุงุญูุงุช ุงูุญุงููุฉ
- ููู ูุชู ุชุนุฑูู ุตูุงุญูุงุช ุฌุฏูุฏุฉ

**ุงููุงุฌูุฉ โ ุตูุญุงุช ุนุฑูุถ ุงูุฃุณุนุงุฑ (ุงููุตุฏุฑ โ ุณุชูููู):**
```
apps/web/app/(saas)/app/(organizations)/[organizationSlug]/finance/quotations/
```
ุงุฏุฑุณ:
- ูู ุงูุตูุญุงุช: ุงููุงุฆูุฉุ ุงูุชูุงุตููุ ุฅูุดุงุกุ ุชุนุฏูู
- ุงูููููุงุช ุงููุณุชุฎุฏูุฉ
- ููู ุชุณุชุฏุนู ุงูู API (ORPC hooks)
- ุฃู imports ูู ูุญุฏุฉ finance

**ุงููุงุฌูุฉ โ ูุญุฏุฉ ุงููุงููุฉ Frontend:**
```
apps/web/modules/saas/finance/                   โ ููููุงุช ุงููุงููุฉ
```
ุงุจุญุซ ุนู:
- ููููุงุช Quotation: forms, tables, cards, dialogs
- ุฃู ููููุงุช ูุดุชุฑูุฉ ุจูู Quotation ูุงูููุงุชูุฑ (ูุซู client selector)
- ุงูู hooks ุฃู utilities ุงูุฎุงุตุฉ ุจุนุฑูุถ ุงูุฃุณุนุงุฑ

**ุงููุงุฌูุฉ โ ุตูุญุงุช ุงููููุงุช (ุงููุณู ุงูุญุงูู โ ุณูุชูุณุน):**
```
apps/web/app/(saas)/app/(organizations)/[organizationSlug]/quantities/
apps/web/modules/saas/quantities/
```
ุงุฏุฑุณ:
- ูููู ุงูุตูุญุงุช ุงูุญุงูู
- ููู ูุชู ุงูุชููู (navigation)
- ูู ููุฌุฏ ุตูุญุฉ `/pricing` ุญุงููุงู ููุงุฐุง ุชุนุฑุถ

**ุงูุชููู (Navigation):**
```
apps/web/modules/saas/shared/                    โ ุฃู ุฃูููุง ูุชู ุชุนุฑูู sidebar/navigation
```
ุงุจุญุซ ุนู:
- ูุงุฆูุฉ ุงูุชููู ุงูุฌุงูุจูุฉ (sidebar)
- ููู ูุชู ุชุนุฑูู ุนูุงุตุฑ ุงููุงุฆูุฉ
- ุฃููููุงุช ุงูุฃูุณุงู
- ุชุฑุชูุจ ุงูุฃูุณุงู ุงูุญุงูู

**ุงูุชุฑุฌูุฉ:**
```
packages/i18n/translations/ar.json
packages/i18n/translations/en.json
```
ุงุจุญุซ ุนู:
- ููุงุชูุญ `finance.quotations.*`
- ููุงุชูุญ `quantities.*`
- ุฃู ููุงุชูุญ `pricing.*` ููุฌูุฏุฉ
- ููุงุชูุญ ุงูุชููู (navigation labels)

**ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
```
packages/database/prisma/queries/                โ ูู ูููุงุช ุงูุงุณุชุนูุงูุงุช
```
ุงุจุญุซ ุนู:
- ุฃู ููู ูุชุนุงูู ูุน `Quotation` ุฃู `QuotationItem`
- ุฃู ููู ูุชุนุงูู ูุน `CostStudy` ุฃู `Quote`
- ุงุณุชุนูุงูุงุช `convertToInvoice`

---

### ุงูุฎุทูุฉ 2: ุถุน ุฎุทุฉ ุชูุตูููุฉ ุชุดูู

ุจุนุฏ ุฏุฑุงุณุฉ ูู ุงููููุงุช ุฃุนูุงูุ ุถุน ุฎุทุฉ ููุณูุฉ ุฅูู **ูุฑุงุญู ุชูููุฐูุฉ** ูุงุถุญุฉ:

#### ุงููุฑุญูุฉ 1: ุงูุชุญุถูุฑ ูุฅูุดุงุก ุงูุจููุฉ ุงูุฌุฏูุฏุฉ

- ุฅูุดุงุก ูุฌูุฏ ูุญุฏุฉ API ุฌุฏูุฏุฉ: `packages/api/modules/pricing/`
- ุฅูุดุงุก ูุฌูุฏ ูุงุฌูุฉ ุฌุฏูุฏ: `apps/web/modules/saas/pricing/`
- ุฅูุดุงุก ูุณุงุฑุงุช ุตูุญุงุช ุฌุฏูุฏุฉ: `apps/web/app/(saas)/app/(organizations)/[organizationSlug]/pricing/`
- ุชุญุฏูุฏ ูููู ุงููุณุงุฑุงุช ุงูุฌุฏูุฏ:
  ```
  /pricing                          โ ููุญุฉ ุชุญูู ุงูุชุณุนูุฑ (ููุฎุต)
  /pricing/studies                   โ ุฏุฑุงุณุงุช ุงููููุงุช (ูุงูุช /quantities)
  /pricing/studies/new               โ ุฏุฑุงุณุฉ ุฌุฏูุฏุฉ
  /pricing/studies/[id]              โ ุชูุงุตูู ุงูุฏุฑุงุณุฉ
  /pricing/studies/[id]/structural   โ ุงูุฅูุดุงุฆู
  /pricing/studies/[id]/mep          โ ุงูููุฑููููุงููู
  /pricing/studies/[id]/finishing    โ ุงูุชุดุทูุจุงุช
  /pricing/studies/[id]/pricing      โ ุชุณุนูุฑ ุงูุฏุฑุงุณุฉ (ููุงูุด ุงูุฑุจุญ)
  /pricing/quotations                โ ุนุฑูุถ ุงูุฃุณุนุงุฑ (ูุงูุช /finance/quotations)
  /pricing/quotations/new            โ ุนุฑุถ ุณุนุฑ ุฌุฏูุฏ
  /pricing/quotations/[id]           โ ุชูุงุตูู ุนุฑุถ ุงูุณุนุฑ
  ```

#### ุงููุฑุญูุฉ 2: ููู ุทุจูุฉ API

- **ููู** procedures ุนุฑูุถ ุงูุฃุณุนุงุฑ ูู `finance/quotations/` ุฅูู `pricing/quotations/`
- **ููู** procedures ุงููููุงุช ูู `quantities/` ุฅูู `pricing/studies/` (ุฃู ุฅุจูุงุคูุง ูุฅุนุงุฏุฉ ุงูุชุตุฏูุฑ)
- **ุชุณุฌูู** ูุญุฏุฉ `pricing` ุงูุฌุฏูุฏุฉ ูู ุงูุฑุงูุชุฑ ุงูุฑุฆูุณู `packages/api/orpc/router.ts`
- **ุฅุฒุงูุฉ** `quotations` ูู ุฑุงูุชุฑ ุงููุงููุฉ `finance/router.ts`
- **ุงูุญูุงุธ ุนูู** `convertToInvoice` โ ูุฐุง ุงูุฅุฌุฑุงุก ูุฑุจุท ุงูุชุณุนูุฑ ุจุงููุงููุฉ ููุฌุจ ุฃู ูุจูู ูุนูู (ุนุฑุถ ุณุนุฑ ููุจูู โ ูุงุชูุฑุฉ)
- **ุงูุชุฃูุฏ** ูู ุฃู ูู ุงูู imports ูุงูู types ุชุนูู ุจุดูู ุตุญูุญ
- **ุชุญุฏูุซ** ุฃุณูุงุก ุงูู procedures ูู ORPC hooks (frontend ุณูุญุชุงุฌ ุชุญุฏูุซ)

#### ุงููุฑุญูุฉ 3: ููู ูุชุญุฏูุซ ุงููุงุฌูุฉ

- **ููู** ููููุงุช ุนุฑูุถ ุงูุฃุณุนุงุฑ ูู `modules/saas/finance/` ุฅูู `modules/saas/pricing/`
- **ููู** ููููุงุช ุงููููุงุช ูู `modules/saas/quantities/` ุฅูู `modules/saas/pricing/`
- **ุฅูุดุงุก** ุตูุญุงุช ุฌุฏูุฏุฉ ุชุญุช `/pricing/*` ูุน ุงุณุชูุฑุงุฏ ุงูููููุงุช ุงููููููุฉ
- **ุชุญุฏูุซ** ูู ุงุณุชุฏุนุงุกุงุช ORPC ูู ุงูููููุงุช:
  - `api.finance.quotations.*` โ `api.pricing.quotations.*`
  - `api.quantities.*` โ `api.pricing.studies.*` (ุฃู ููุง ููุงุณุจ)
- **ุญุฐู** ุตูุญุงุช `/finance/quotations/*` ุงููุฏููุฉ
- **ุญุฐู** ุตูุญุงุช `/quantities/*` ุงููุฏููุฉ (ุฅุฐุง ุชู ุงูููู ุงููุงูู)
- **ุฅูุดุงุก** ุตูุญุฉ ููุญุฉ ุชุญูู ุงูุชุณุนูุฑ `/pricing` โ ุชุนุฑุถ ููุฎุต: ุนุฏุฏ ุงูุฏุฑุงุณุงุช + ุนุฏุฏ ุงูุนุฑูุถ + ูุณุจุฉ ุงููุจูู

#### ุงููุฑุญูุฉ 4: ุชุญุฏูุซ ุงูุชููู ูุงูุตูุงุญูุงุช

- **ุชุญุฏูุซ** ูุงุฆูุฉ ุงูุชููู ุงูุฌุงูุจูุฉ (Sidebar):
  - ุฅุฒุงูุฉ "ุงููููุงุช" ูู ุงููุงุฆูุฉ
  - ุฅุฒุงูุฉ "ุนุฑูุถ ุงูุฃุณุนุงุฑ" ูู ุชุญุช ุงููุงููุฉ
  - ุฅุถุงูุฉ "ุงูุชุณุนูุฑ" ููุณู ุฌุฏูุฏ ุจูู "ุงููุดุงุฑูุน" ู "ุงููุงููุฉ"
  - ุงูุชุฑุชูุจ ุงูููุงุฆู: ููุญุฉ ุงูุชุญูู โ ุงููุดุงุฑูุน โ **ุงูุชุณุนูุฑ** โ ุงููุงููุฉ โ ุงูููุดุฃุฉ โ ุงูุฅุนุฏุงุฏุงุช
- **ุชุญุฏูุซ** ุงูุตูุงุญูุงุช ูู `permissions.ts`:
  - ุฅูุดุงุก ูุณู `pricing.*` ุฌุฏูุฏ ูุดูู:
    ```
    pricing.view          โ ุนุฑุถ ูุณู ุงูุชุณุนูุฑ
    pricing.studies       โ ุฅุฏุงุฑุฉ ุฏุฑุงุณุงุช ุงููููุงุช
    pricing.quotations    โ ุฅุฏุงุฑุฉ ุนุฑูุถ ุงูุฃุณุนุงุฑ
    pricing.pricing       โ ุงูุชุณุนูุฑ ูููุงูุด ุงูุฑุจุญ
    ```
  - ุชุญุฏูุซ ูุตูููุฉ ุงูุฃุฏูุงุฑ:
    - OWNER: ูู ุตูุงุญูุงุช ุงูุชุณุนูุฑ โ
    - PROJECT_MANAGER: view + studies + quotations + pricing โ
    - ACCOUNTANT: view + quotations (ุนุฑุถ ููุท) โ
    - ENGINEER: view + studies โ
    - SUPERVISOR: view ููุท โ
  - **ุฅุฒุงูุฉ** `finance.quotations` ูู ุงูุตูุงุญูุงุช ุงููุฏููุฉ
  - **ุงูุญูุงุธ ุนูู** ุฃู ุชุฑุญูู `quantities.*` ุฅูู `pricing.studies`
- **ุชุญุฏูุซ** ูู ูููุงุช ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ุงูุชู ุชุดูุฑ ุฅูู `finance.quotations` ุฃู `quantities`

#### ุงููุฑุญูุฉ 5: ุชุญุฏูุซ ุงูุชุฑุฌูุฉ

- **ุฅูุดุงุก** ูุณู `pricing` ุฌุฏูุฏ ูู `ar.json` ู `en.json`:
  ```json
  "pricing": {
    "title": "ุงูุชุณุนูุฑ",
    "description": "ุฅุฏุงุฑุฉ ุฏุฑุงุณุงุช ุงููููุงุช ูุนุฑูุถ ุงูุฃุณุนุงุฑ",
    "studies": {
      "title": "ุฏุฑุงุณุงุช ุงููููุงุช",
      ...
    },
    "quotations": {
      "title": "ุนุฑูุถ ุงูุฃุณุนุงุฑ",
      ...
    },
    "dashboard": {
      "title": "ููุฎุต ุงูุชุณุนูุฑ",
      "totalStudies": "ุฅุฌูุงูู ุงูุฏุฑุงุณุงุช",
      "totalQuotations": "ุฅุฌูุงูู ุงูุนุฑูุถ",
      "acceptanceRate": "ูุณุจุฉ ุงููุจูู",
      "pendingQuotations": "ุนุฑูุถ ูุนููุฉ",
      ...
    }
  }
  ```
- **ููู** ููุงุชูุญ `finance.quotations.*` ุงูููุฌูุฏุฉ ุฅูู `pricing.quotations.*`
- **ููู** ููุงุชูุญ `quantities.*` ุงูููุฌูุฏุฉ ุฅูู `pricing.studies.*`
- **ุชุญุฏูุซ** ููุงุชูุญ ุงูุชููู
- **ุฅุฒุงูุฉ** ุงูููุงุชูุญ ุงููุฏููุฉ ุฃู ูุถุน redirects ูุคูุชุฉ

#### ุงููุฑุญูุฉ 6: ุชูุธูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุชุฎุทูุท ููุท โ ูุง ุชูููุฐ ููุฑู)

โ๏ธ **ูุฐู ุงููุฑุญูุฉ ููุชุฎุทูุท ููุท โ ูุง ุชูููุฐ ุฅูุง ุจุนุฏ ุงูุชุฃูุฏ ูู ุนูู ูู ุดูุก**

- ุฎุทุฉ ูุชูุญูุฏ `Quote` (ุงููููุงุช) ูุน `Quotation` (ุงููุงููุฉ):
  - ุชุญุฏูุฏ ุงููุฑููุงุช ุจูู ุงูุฌุฏูููู
  - ูู ูููู ุฏูุฌููุงุ ุฃู ูุจููุงู ูููุตููู ุจุนูุงูุฉ ูุงุถุญุฉุ
  - ุฅุฐุง ูุงู `Quote` ูู "ุชุณุนูุฑ ุฏุฑุงุณุฉ" ู `Quotation` ูู "ุนุฑุถ ุณุนุฑ ููุนููู" โ ููุฏ ููููุงู ูุฎุชูููู ูุนูุงู
  - ุงูุชุฑุงุญ: `CostStudy` โ ูููุฏ โ `Quotation` (ุจุฑุจุท `costStudyId`)
  - ุฅุฒุงูุฉ `Quote` ุฅุฐุง ูุงู ููุฑุฑุงู

#### ุงููุฑุญูุฉ 7: ุงูุชุญูู ูุงูุงุฎุชุจุงุฑ

- ูุงุฆูุฉ ุจูู ุงููุณุงุฑุงุช ุงูุชู ูุฌุจ ุงุฎุชุจุงุฑูุง:
  - `/pricing` โ ุชุญููู ููุญุฉ ุงูุชุญูู
  - `/pricing/studies` โ ูุงุฆูุฉ ุงูุฏุฑุงุณุงุช
  - `/pricing/studies/new` โ ุฅูุดุงุก ุฏุฑุงุณุฉ
  - `/pricing/studies/[id]/*` โ ูู ุตูุญุงุช ุงูุฏุฑุงุณุฉ ุงููุฑุนูุฉ
  - `/pricing/quotations` โ ูุงุฆูุฉ ุนุฑูุถ ุงูุฃุณุนุงุฑ
  - `/pricing/quotations/new` โ ุฅูุดุงุก ุนุฑุถ ุณุนุฑ
  - `/pricing/quotations/[id]` โ ุชูุงุตูู ุงูุนุฑุถ
  - ุชุญููู ุนุฑุถ ุณุนุฑ ููุจูู ุฅูู ูุงุชูุฑุฉ (ุงูุฑุจุท ูุน ุงููุงููุฉ)
  - ุฅูุดุงุก ุนุฑุถ ุณุนุฑ ูู ุฏุฑุงุณุฉ ุชูููุฉ
  - ุฅูุดุงุก ุนุฑุถ ุณุนุฑ ุณุฑูุน (ุจุฏูู ุฏุฑุงุณุฉ)
- **ุงูุชุฃูุฏ** ูู ุฃู ุงููุงููุฉ ูุง ุชุฒุงู ุชุนูู ุจุงููุงูู ุจุฏูู ุนุฑูุถ ุงูุฃุณุนุงุฑ
- **ุงูุชุฃูุฏ** ูู ุฃู ุงูุตูุงุญูุงุช ุชุนูู ููู ุฏูุฑ
- **ุงูุชุฃูุฏ** ูู ุฃู ุงูุชุฑุฌูุฉ ูุงููุฉ (ุนุฑุจู + ุฅูุฌููุฒู)
- **ุงูุชุฃูุฏ** ูู ุฃู ุงูุชููู ูุนูู ุจุดูู ุตุญูุญ
- **ุงูุชุฃูุฏ** ูู ุฃู RTL ูุนูู ูู ูู ุงูุตูุญุงุช ุงูุฌุฏูุฏุฉ
- **ูุญุต** ุฃู ูุง ููุฌุฏ imports ููุณูุฑุฉ ุฃู dead references

---

### ุงูุฎุทูุฉ 3: ููุงุนุฏ ูููุฉ ุฃุซูุงุก ุงูุชูููุฐ

1. **ูุง ุชูุณุฑ ูุง ูุนูู** โ ุงููุงููุฉ ูุฌุจ ุฃู ุชุณุชูุฑ ุจุงูุนูู ูุงููุฉ (ููุงุชูุฑ + ูุตุฑููุงุช + ูุฏููุนุงุช + ุญุณุงุจุงุช)
2. **ุญุงูุธ ุนูู ุฃููุงุท ุงููุดุฑูุน** โ ุงุณุชุฎุฏู ููุณ ุฃููุงุท ORPC (`protectedProcedure`, `organizationId` isolation, membership checks)
3. **ุญุงูุธ ุนูู `convertToInvoice`** โ ูุฐุง ูุฑุจุท ุงูุชุณุนูุฑ ุจุงููุงููุฉ ููุฌุจ ุฃู ูุนูู: ุนุฑุถ ุณุนุฑ ููุจูู โ ุฒุฑ ุชุญููู โ ูุงุชูุฑุฉ ูู ุงููุงููุฉ
4. **ุนุฑุจู ุฃููุงู** โ ูู ุงููุตูุต ุงูุฌุฏูุฏุฉ ุชููุชุจ ุจุงูุนุฑุจู ุฃููุงู ุซู ุงูุฅูุฌููุฒู
5. **RTL** โ ูู ุงูููููุงุช ุงูุฌุฏูุฏุฉ ูุฌุจ ุฃู ุชุฏุนู RTL
6. **Atomic commits** โ ูู ูุฑุญูุฉ ูู commit ูููุตู ุญุชู ูููู ุงูุชุฑุงุฌุน
7. **ูุง ุชููุณ schema.prisma ูู ุงููุฑุงุญู ุงูุฃููู** โ ุงูุชุบููุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ูุซู ุฏูุฌ Quote + Quotation) ุชุฃุชู ุขุฎุฑุงู
8. **ุฏุนู ุงููุณุงุฑ ุงููุฒุฏูุฌ ูุนุฑูุถ ุงูุฃุณุนุงุฑ:**
   - ุนุฑุถ ุณุนุฑ **ุณุฑูุน** (ุจููุฏ ูุฏููุฉ ุจุฏูู ุฏุฑุงุณุฉ) โ ููููุงูู ุงูุตุบูุฑ
   - ุนุฑุถ ุณุนุฑ **ูู ุฏุฑุงุณุฉ** (ููููุฏ ูู CostStudy) โ ููุดุฑูุงุช ุงููุชูุณุทุฉ
   - ููุงููุง ุชุญุช `/pricing/quotations` โ ุงููุงุฌูุฉ ุชููุฑ ุงูุฎูุงุฑูู
9. **Redirects** โ ุฃุถู redirects ูู ุงููุณุงุฑุงุช ุงููุฏููุฉ ุฅูู ุงูุฌุฏูุฏุฉ:
   - `/quantities/*` โ `/pricing/studies/*`
   - `/finance/quotations/*` โ `/pricing/quotations/*`

---

### ููุฎุต ุงููููู ุงูููุงุฆู ุงููุทููุจ

**API (ORPC Router):**
```
pricing/
โโโ router.ts                    โ ุงูุฑุงูุชุฑ ุงูุฑุฆูุณู ููุชุณุนูุฑ
โโโ dashboard/                   โ ููุฎุต: ุนุฏุฏ ุงูุฏุฑุงุณุงุช + ุงูุนุฑูุถ + ูุณุจุฉ ุงููุจูู
โโโ studies/                     โ (ูุงูุช quantities)
โ   โโโ list
โ   โโโ getById
โ   โโโ create
โ   โโโ update
โ   โโโ delete
โ   โโโ structural/              โ ุจููุฏ ุฅูุดุงุฆูุฉ
โ   โโโ finishing/               โ ุจููุฏ ุชุดุทูุจุงุช
โ   โโโ mep/                     โ ุจููุฏ ููุฑููููุงููู
โ   โโโ labor/                   โ ุจููุฏ ุนูุงูุฉ
โ   โโโ pricing/                 โ ุชุณุนูุฑ ุงูุฏุฑุงุณุฉ (overhead + profit)
โโโ quotations/                  โ (ูุงูุช finance/quotations)
    โโโ list
    โโโ getById
    โโโ create                   โ ูุฏุนู: ูู ุฏุฑุงุณุฉ ุฃู ูุฏูู
    โโโ update
    โโโ updateItems
    โโโ updateStatus
    โโโ delete
    โโโ convertToInvoice         โ ูุธู ูุฑุจุท ุจุงููุงููุฉ
```

**ุตูุญุงุช Frontend:**
```
/pricing                              โ ููุญุฉ ุชุญูู
/pricing/studies                      โ ูุงุฆูุฉ ุงูุฏุฑุงุณุงุช
/pricing/studies/new                  โ ุฏุฑุงุณุฉ ุฌุฏูุฏุฉ
/pricing/studies/[id]                 โ ูุธุฑุฉ ุนุงูุฉ
/pricing/studies/[id]/structural      โ ุงูุฅูุดุงุฆู
/pricing/studies/[id]/mep             โ ุงูููุฑููููุงููู
/pricing/studies/[id]/finishing       โ ุงูุชุดุทูุจุงุช
/pricing/studies/[id]/pricing         โ ุงูุชุณุนูุฑ
/pricing/quotations                   โ ูุงุฆูุฉ ุนุฑูุถ ุงูุฃุณุนุงุฑ
/pricing/quotations/new               โ ุนุฑุถ ุฌุฏูุฏ (ุณุฑูุน ุฃู ูู ุฏุฑุงุณุฉ)
/pricing/quotations/[id]              โ ุชูุงุตูู ุงูุนุฑุถ
```

**ุงูุชููู ุงูุฌุงูุจู (Sidebar) โ ุงูุชุฑุชูุจ ุงูููุงุฆู:**
```
๐ ููุญุฉ ุงูุชุญูู
๐ ุงููุดุงุฑูุน
๐ฐ ุงูุชุณุนูุฑ          โ ุฌุฏูุฏ (ูุฌูุน ุงููููุงุช + ุนุฑูุถ ุงูุฃุณุนุงุฑ)
   โโ ุฏุฑุงุณุงุช ุงููููุงุช
   โโ ุนุฑูุถ ุงูุฃุณุนุงุฑ
๐ฆ ุงููุงููุฉ           โ ุจุฏูู ุนุฑูุถ ุงูุฃุณุนุงุฑ
   โโ ุงูููุงุชูุฑ
   โโ ุงููุตุฑููุงุช
   โโ ุงูููุจูุถุงุช
   โโ ุงูุญุณุงุจุงุช ุงูุจูููุฉ
   โโ ...
๐ข ุงูููุดุฃุฉ
โ๏ธ ุงูุฅุนุฏุงุฏุงุช
```

**ุงูุตูุงุญูุงุช:**
```
pricing.view          โ OWNER โ | PM โ | ACCT โ | ENG โ | SUP โ
pricing.studies       โ OWNER โ | PM โ | ACCT โ | ENG โ | SUP โ
pricing.quotations    โ OWNER โ | PM โ | ACCT โ | ENG โ | SUP โ
pricing.pricing       โ OWNER โ | PM โ | ACCT โ | ENG โ | SUP โ
```

---

### โ๏ธ ููุงุท ุงูุชุจุงู ุฎุงุตุฉ

1. **`convertToInvoice`** ูู ุงูุฑุจุท ุงูุญููู ุจูู ุงูุชุณุนูุฑ ูุงููุงููุฉ โ ุชุฃูุฏ ุฃูู ูุนูู ุจุนุฏ ุงูููู
2. **ููููุงุช ูุดุชุฑูุฉ** ูุซู `ClientSelector` ุฃู `ItemsTable` ูุฏ ุชููู ูู ูุญุฏุฉ ุงููุงููุฉ ูุชูุณุชุฎุฏู ูู ุนุฑูุถ ุงูุฃุณุนุงุฑ โ ูุฌุจ ููููุง ุฅูู `shared` ุฃู ุชูุฑุงุฑูุง
3. **ุงูู Zod schemas** ุงููููุฏุฉ ุชููุงุฆูุงู ูู Prisma ูู ุชุชุบูุฑ (ูุฃููุง ูุง ูููุณ schema.prisma) โ ููู ุชุฃูุฏ ูู ุฃู ุงูู imports ุตุญูุญุฉ
4. **TanStack Query cache keys** ุณุชุชุบูุฑ ูุน ุชุบููุฑ ุงุณู ุงูู procedure โ ุชุฃูุฏ ูู ุฃู ุงูู invalidation ูุนูู
5. **breadcrumbs** ูู ุงูุตูุญุงุช โ ูุฌุจ ุชุญุฏูุซูุง ูุชุนูุณ ุงููุณุงุฑ ุงูุฌุฏูุฏ
6. **ุฑุงุจุท "ุนุฑูุถ ุงูุฃุณุนุงุฑ" ุฏุงุฎู ุตูุญุงุช ุงููุดุฑูุน** (`/projects/[id]/finance`) โ ุฅุฐุง ูุงู ูุดูุฑ ูุนุฑูุถ ุงูุฃุณุนุงุฑุ ูุฌุจ ุชุญุฏูุซู

---

## ุงุจุฏุฃ ุงูุขู

1. **ุงูุฑุฃ ูู ุงููููุงุช ุงููุฐููุฑุฉ ูู ุงูุฎุทูุฉ 1** โ ุฎุฐ ููุชู
2. **ุณุฌูู ููุงุญุธุงุชู** ุนู ูู ููู โ ูุงุฐุง ูุฌุฏุชุ ูุง ูู ุงูุนูุงูุงุชุ ูุง ูู ุงููุฎุงุทุฑ
3. **ุถุน ุงูุฎุทุฉ ุงูุชูุตูููุฉ** ูุน:
   - ูุงุฆูุฉ ุงููููุงุช ุงูุชู ุณุชููุดุฃ
   - ูุงุฆูุฉ ุงููููุงุช ุงูุชู ุณุชูุนุฏู
   - ูุงุฆูุฉ ุงููููุงุช ุงูุชู ุณุชูุญุฐู
   - ุชุฑุชูุจ ุงูุชูููุฐ (ูุง ููููุฐ ุฃููุงู)
   - ุงููุฎุงุทุฑ ุงููุญุชููุฉ ูููููุฉ ุชุฌูุจูุง
4. **ุงุนุฑุถ ุงูุฎุทุฉ ุนููู ููููุงููุฉ** ูุจู ุงูุจุฏุก ูู ุงูุชูููุฐ

ูุง ุชุจุฏุฃ ุจูุชุงุจุฉ ุฃู ููุฏ ุญุชู ุชูุชูู ูู ุงูุฏุฑุงุณุฉ ูุงูุฎุทุฉ ูุฃูุงูู ุนูููุง.
